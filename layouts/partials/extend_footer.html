<script>
document.addEventListener("DOMContentLoaded", function () {
  const content = document.querySelector(".post-content");
  if (!content) return;

  // 1) Trouver la TOC (wrapper ou #TableOfContents)
  const wrapperCandidate = document.querySelector("aside.toc, .post-single > .toc, .single > .toc, .toc");
  const tocId = document.getElementById("TableOfContents");
  let tocEl = null;

  if (wrapperCandidate && tocId && wrapperCandidate.contains(tocId)) {
    tocEl = wrapperCandidate;   // déplacer tout le wrapper (contient summary + TOC)
  } else if (tocId) {
    tocEl = tocId;              // déplacer #TableOfContents seul
  } else if (wrapperCandidate) {
    tocEl = wrapperCandidate;   // fallback : wrapper sans #TableOfContents (rare)
  } else {
    return; // pas de TOC
  }

  // 2) Créer/obtenir le wrapper colonne contenu
  let col = content.querySelector(":scope > .content-col");
  if (!col) {
    col = document.createElement("div");
    col.className = "content-col";
  }

  // 3) Déplacer DANS .content-col tout ce qui n'est pas la TOC
  const children = Array.from(content.children);
  children.forEach(ch => {
    if (ch === tocEl) return;
    if (ch.id === "TableOfContents") return;
    if (ch.classList && ch.classList.contains("toc")) return;
    col.appendChild(ch);
  });

  // 4) Reconstruire .post-content : d'abord le contenu, puis la TOC
  content.innerHTML = "";
  content.appendChild(col);
  content.appendChild(tocEl);

  // 5) Nettoyage : supprimer tout summary/aside.toc resté EN DEHORS de .post-content (fantômes)
  document.querySelectorAll("summary, aside.toc, .toc").forEach(el => {
    if (!content.contains(el)) {
      try { el.remove(); } catch(e) {}
    }
  });
});
</script>

