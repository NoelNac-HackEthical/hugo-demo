{{ define "main" }}
<main class="main">
  <article class="post-single">
    <header class="post-header">
      <h1>{{ .Title }}</h1>
      {{ partial "post-meta.html" . }}
    </header>

    <!-- Intro de la section / taxonomie : d'abord la description du front matter -->
    <div class="post-content">
      <div class="post-article no-cols">
        {{ with .Params.description }}
          <p class="section-desc">{{ . }}</p>
        {{ end }}
        {{/* On affiche ensuite le contenu complet s'il existe */}}
        {{ with .Content }}
          {{ . }}
        {{ end }}
      </div>
    </div>

    {{/* Sélection des éléments à lister (sections & taxonomies) */}}
    {{ $items := slice }}
    {{ if .IsSection }}
      {{ $items = .RegularPages }}
      {{ if eq (len $items) 0 }}{{ $items = .Pages }}{{ end }}
      {{ if eq (len $items) 0 }}{{ $items = .RegularPagesRecursive }}{{ end }}
    {{ else if or (eq .Kind "taxonomy") (eq .Kind "term") }}
      {{ $items = .Pages }}
    {{ end }}

    {{ if gt (len $items) 0 }}
      {{ $items = $items.ByTitle }}

      <div class="list-cards">
        {{ range $items }}
          <a class="list-card" href="{{ .RelPermalink }}">
            <div class="list-card__body">
              <h2 class="list-card__title">{{ .Title }}</h2>
              {{ with .Params.description }}
                <p class="list-card__desc">{{ . }}</p>
              {{ else }}
                {{ with .Summary }}<p class="list-card__desc">{{ . }}</p>{{ end }}
              {{ end }}
            </div>
          </a>
        {{ end }}
      </div>
    {{ end }}
  </article>
</main>
{{ end }}
