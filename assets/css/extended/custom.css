/* ==========================================================================
   Custom site CSS – PaperMod
   ========================================================================== */

/* -------------------------------
   Variables globales utiles
   ------------------------------- */
:root {
  /* Home / cadres */
  --summary-border: #555;             /* clair */
  --toc-width: 320px;

  /* Tags (clair) */
  --tag-fg: #1E90FF;
  --tag-bg: rgba(127,127,127,.15);
  --tag-fg-hover-light: #003366;
  --tag-bg-hover-light: rgba(127,127,127,.40);
}
html.dark, body.dark {
  --summary-border: #ccc;             /* sombre */

  /* Tags (sombre) */
  --tag-fg: #9ecbff;
  --tag-bg: rgba(255,255,255,.15);
  --tag-fg-hover-dark: #ffffff;
  --tag-bg-hover-dark: rgba(255,255,255,.30);
}

/* ==========================================================================
   1) TOC à droite – robuste (grille), sticky, titrée & numérotée
   ========================================================================== */

/* Grille 2 colonnes dans l'article : contenu | TOC */
.post-content{
  display: grid;
  grid-template-columns: minmax(0,1fr) var(--toc-width);
  column-gap: 2rem;
  align-items: start;
}

/* TOC en colonne 2, panneau sticky */
.post-content #TableOfContents{
  grid-column: 2;
  position: sticky;
  top: 2rem;
  z-index: 5;
  max-height: calc(100vh - 4rem);
  overflow: auto;

  background: var(--entry);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: .75rem 1rem;
}

/* Le reste du contenu reste en colonne 1 */
.post-content > :not(#TableOfContents){ grid-column: 1; }

/* Titre "Sommaire" */
.post-content #TableOfContents::before{
  content: "Sommaire";
  display: block;
  font-weight: 700;
  margin: 0 0 .4rem;
}

/* Numérotation H2/H3 dans la TOC */
.post-content #TableOfContents ul{ list-style: none; padding-left: 0; margin: 0; counter-reset: toc-h2; }
.post-content #TableOfContents > ul > li{ counter-increment: toc-h2; }
.post-content #TableOfContents > ul > li > a::before{
  content: counter(toc-h2) ". ";
  margin-right: .25em;
}
.post-content #TableOfContents ul ul{ counter-reset: toc-h3; padding-left: 1rem; }
.post-content #TableOfContents ul ul > li{ counter-increment: toc-h3; }
.post-content #TableOfContents ul ul > li > a::before{
  content: counter(toc-h2) "." counter(toc-h3) " ";
  margin-right: .25em;
}

/* Responsive : en mobile, mono-colonne, TOC sous le contenu */
@media (max-width: 991px){
  .post-content{ display: block; }
  .post-content #TableOfContents{
    position: static;
    max-height: none;
    margin-top: 1rem;
  }
}

/* ==========================================================================
   2) Bloc Résumé + vignette (pages article)
   ========================================================================== */
.post-content .summary-image-row{
  display: flex;
  align-items: flex-start;
  gap: .75rem;
  margin-top: .25rem;
  margin-bottom: .5rem;

  border: 1px solid var(--summary-border);
  border-radius: 8px;
  padding: .75rem;

  /* largeur harmonisée avec la home */
  max-width: 860px;
}
.post-content .post-summary{ margin: 0; }
.post-content .thumb-wrap{
  display: block;
  border-radius: 10px;
  overflow: hidden;
  flex-shrink: 0;
  width: 120px; height: 120px;
}
.post-content .thumb-wrap img{
  display: block; width: 100%; height: 100%; object-fit: cover;
}

/* ==========================================================================
   3) Home – liste + carte résumé
   ========================================================================== */
.home-min { max-width: 860px; margin: 0 auto; padding: 1rem; }

.post-list { list-style: none; margin: 0; padding: 0; display: grid; gap: 1.0rem; }
.post-item { border-bottom: 1px solid var(--border, rgba(127,127,127,.25)); padding-bottom: 1rem; }
.post-title { font-size: 1.2rem; margin: 0 0 .25rem; }
.post-title a { text-decoration: none; }
.post-meta { font-size: .9rem; opacity: .8; margin-bottom: .35rem; }
.post-summary { margin: 0; }

/* Ligne texte + vignette */
.summary-image-row{
  display: flex;
  align-items: flex-start;
  gap: .75rem;
  margin-top: .25rem;

  border: 1px solid var(--summary-border);
  border-radius: 8px;
  padding: .75rem;
}
.thumb-wrap{
  display: block; border-radius: 10px; overflow: hidden;
  flex-shrink: 0; width: 120px; height: 120px;
}
.thumb-wrap img{ display: block; width: 100%; height: 100%; object-fit: cover; }

.pager { display: flex; gap: .75rem; justify-content: center; margin-top: 1rem; }

/* Responsive home */
@media (max-width: 720px){
  .summary-image-row { flex-direction: column; }
  .thumb-wrap { width: 100%; max-width: 240px; height: auto; aspect-ratio: 1 / 1; }
}

/* ==========================================================================
   4) Tags unifiés (home + writeups)
   ========================================================================== */
.post-tags{ display:flex; flex-wrap:wrap; gap:.4rem; margin-top:.25rem; }
.post-tags .tag{
  font-size:.85rem; font-weight:700; text-decoration:none;
  color: var(--tag-fg); background-color: var(--tag-bg);
  padding:.08rem .4rem; border-radius:999px; transition:.2s; outline:none;
}
html:not(.dark) .post-tags .tag:hover,
html:not(.dark) .post-tags .tag:focus-visible{
  color: var(--tag-fg-hover-light) !important;
  background-color: var(--tag-bg-hover-light) !important;
}
html.dark .post-tags .tag:hover,
html.dark .post-tags .tag:focus-visible,
body.dark .post-tags .tag:hover,
body.dark .post-tags .tag:focus-visible{
  color: var(--tag-fg-hover-dark) !important;
  background-color: var(--tag-bg-hover-dark) !important;
}
/* Accessibilité : anneau clavier */
.post-tags .tag:focus-visible{ outline: 2px solid currentColor; outline-offset: 2px; }

/* ==========================================================================
   5) Surlignage Search (occurrences & active)
   - sombre : occurrences texte jaune vif, active noir sur fond jaune
   - clair  : occurrences texte orange vif, active orange sur fond jaune
   ========================================================================== */
mark.__hl{
  background: none; font-weight: 700;
}
html.dark mark.__hl{
  color: #ffe066;   /* jaune vif */
}
html:not(.dark) mark.__hl{
  color: #e67e22;   /* orange vif */
}
mark.__hl.__hl-active{
  background: #ffea70;
}
html.dark mark.__hl.__hl-active{
  color: #111;      /* noir sur fond jaune en sombre */
}
html:not(.dark) mark.__hl.__hl-active{
  color: #b65e0e;   /* orange plus sombre en clair */
}
/* mini barre nav search (si présente) au-dessus du contenu */
.__hl-nav{
  position: fixed; right: .75rem; bottom: .75rem;
  display:flex; align-items:center; gap:.35rem;
  background: var(--entry); border:1px solid var(--border);
  border-radius: 8px; padding: .35rem .5rem; z-index: 9999;
}

/* ==========================================================================
   6) Numérotation automatique dans le contenu (H2/H3/H4)
   ========================================================================== */
.post-content{ counter-reset: h2counter; }
.post-content h2{ counter-reset: h3counter; }
.post-content h3{ counter-reset: h4counter; }

/* H2 => 1. 2. 3. ... */
.post-content h2::before{
  counter-increment: h2counter;
  content: counter(h2counter) ". ";
  font-weight: 600; margin-right: .25em;
}
/* H3 => 1.1 1.2 ... */
.post-content h3::before{
  counter-increment: h3counter;
  content: counter(h2counter) "." counter(h3counter) " ";
  margin-right: .25em;
}
/* H4 => 1.1.1 ... */
.post-content h4::before{
  counter-increment: h4counter;
  content: counter(h2counter) "." counter(h3counter) "." counter(h4counter) " ";
  margin-right: .25em;
}
/* Désactivation sur .nonum si besoin */
.post-content h2.nonum::before,
.post-content h3.nonum::before,
.post-content h4.nonum::before{ content:""; counter-increment:none; }

/* ==========================================================================
   7) Petits ajustements
   ========================================================================== */
/* S'assure que l'article reste bloc (au cas où un ancien CSS le mettait en flex) */
.post-single{ display:block; }
